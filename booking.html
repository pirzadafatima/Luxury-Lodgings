<!DOCTYPE html>
<html>
<head>
	<title>Hotel Room Types</title>
    <link rel="stylesheet" href="booking_style.css">

</head>
<body>
	<div class="header">
		<img src="images/logo.jpeg" alt="Hotel Logo">
	</div>
    <div class="Check_in_Availability">
        <div class="check_in">
                 <div>
                  <label for="date">Check in</label>
                  <input type="date" id="checkInDate">
                 </div>
      	</div>
      	<div class="check_out">
          <div>
              <label for="date_check">Check out </label>
              <input type="date" id="checkOutDate">
          </div>
        </div>
      	<button class="check_button" id="checkbtn">
          <span>
              Check Available Rooms
          </span>
     	</button>
	  	<div class="TotalBill">
			<div>
		 		<h2 id="bill">
					Lodging Fee: $0
				</h2>
			</div>
		</div>
  	</div>
	<div class="container">
		<div class="room-type">
			<img src="https://www.travelandleisure.com/thmb/KtXNAD3uHjtQoBPKxWRhbMygrSo=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/MacArthur-Place-Hotel--Spa-Fireplace-Room-a3078a9f2510495d9c66441386ad111f.jpg" alt="Standard Room">
			<h2>Standard Room</h2>
			<p class="Price">Price per night: $150</p>
			<label for="standard-rooms">Select no of Rooms</label>
			<select class="Selectrooms"id="standard-rooms" data-price="150" disabled> <!--disabled is an attribute to disable the functionaliity 
				whenever we want. at first our user can't select no of rooms but when he goes through the prcedure of check in the selection of room enabled and user can seelct the rooms -->
				<option value="0">0</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
			</select>
		</div>
		<div class="room-type">
			<img src="https://m.fourseasons.com/alt/img-opt/~70.1530.0,0000-0,0000-1600,0000-900,0000/publish/content/dam/fourseasons/images/web/KYO/KYO_101_aspect16x9.jpg" alt="Deluxe Room">
			<h2>Garden View Room</h2>
			<p class="Price">Price per night: $350</p>
			<label for="Garden View">Select no of Rooms</label>
			<select class="Selectrooms" id="GardenViewRoom" data-price="350" disabled>
				<option value="0">0</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
			</select>
		</div>
		<div class="room-type">
			<img src="https://www.adelphihospitality.com/application/files/2515/6516/9757/201907_Adelphi_Grande_Sukhumvit_Hotel_-_Room_401_Living_Area_and_Dining_Area.jpg" alt="Deluxe Room">
			<h2>Family Suite</h2>
			<p class="Price">Price per night: $450</p>
			<label for="Family">Select no of Rooms</label>
			<select class="Selectrooms" id="FamilySuite" data-price="450" disabled>
				<option value="0">0</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
			</select>
		</div>
		<div class="room-type">
			<img src="https://hi-cdn.t-rp.co.uk/images/rooms/0/50841"  alt="Deluxe Room">
			<h2>Executive Room</h2>
			<p class="Price">Price per night: $400</p>
			<label for="Executive Room">Select no of Rooms</label>
			<select class="Selectrooms" id="ExecutiveRoom" data-price="400" disabled >
				<option value="0">0</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
			</select>
		</div>
		<div class="room-type">
			<img src="https://www.landmarklondon.co.uk/wp-content/uploads/2018/01/Executive-Family-Room-1-1.jpg" alt="Deluxe Room">
			<h2>Deluxe Room</h2>
			<p class="Price">Price per night: $500</p>
			<label for="deluxe-rooms">Select no of Rooms</label>
			<select class="Selectrooms" id="deluxerooms" data-price="500" disabled>
				<option value="0">0</option>
				<option value="1">1</option>
				<option value="2">2</option>
				<option value="3">3</option>
				<option value="4">4</option>
			</select>
		</div>	
	</div>
	 <script>
		
	// a user check in only present date and check out at future date

		var Today=new Date();
		var TodaysDate = Today.getDate();
		// the formate of Date in date function is different from minDate function. in order to set the min date as present date we have to convert into the format of minDAte and set present date as min date.
		// purpose of min date is that the user can only select dates from our mindate (set to present date) to above.
		if (TodaysDate<10)
		{
			TodaysDate = '0'+TodaysDate;  // it is string based comparison e.g 4 and 04 are two different things in string so if a date is less than 10 we have to add 0 before date . Same for month
		}
		var TodaysMonth = Today.getMonth()+1; // Reason behind to add 1 in month is that in js date function months start from 0 but in normal it start from 1 .
		if (TodaysMonth<10)
		{
			TodaysMonth = '0'+TodaysMonth;
		}
		var TodaysYear = Today.getUTCFullYear();
		if (TodaysYear<10)
		{
			TodaysYear = '0'+TodaysYear;
		}
		var minDate=0;

		minDate = TodaysYear + "-" + TodaysMonth + "-"+ TodaysDate ; // format of min date function
		document.getElementById("checkInDate").setAttribute('min' ,minDate ); //setting min date value for check in
		var TommorowDate = Today.getDate()+1;  // check out must be 1 day above from check in date
		if (TommorowDate<10)
		{
			TommorowDate = '0'+TommorowDate;
		}
		var minFDate = TodaysYear + "-" + TodaysMonth + "-"+ TommorowDate ;
		document.getElementById("checkOutDate").setAttribute('min' ,minFDate );   //setting min date value for check out
		
		
		// a user click on available rooms , the available rooms will be shown on site after searching from database
		
		var check_button=document.getElementById('checkbtn');
		const datePicker1 = document.getElementById("checkInDate");
		const datePicker2 = document.getElementById("checkOutDate");
		var selects = document.getElementsByTagName("select");
		var Days=0;

		//At this point it is an temporary functiiality , in future it will change
		// the procedure is that user first input the check in date , the first listener will be activate and set the new min value range of check in 
		// then user input check out date the second listener will activate and then user  click on check available rooms button
		// if a user perform this procedure only then he will select no of rooms .
		datePicker1.addEventListener("input", ()=>{
			if (datePicker1.value)
			{
				
				var futureDate=new Date(datePicker1.value);
				var minfutureDate = futureDate.getDate()+1;
				if (minfutureDate<10)
				{
					minfutureDate = '0'+minfutureDate;
				}
				var minfutureMonth = futureDate.getMonth()+1;
				if (minfutureMonth<10)
				{
					minfutureMonth = '0'+minfutureMonth;
				}
				var minfutureYear = futureDate.getUTCFullYear();
				if (minfutureYear<10)
				{
					minfutureYear = '0'+minfutureYear;
				}
				var minFDate=0;
			    minFDate = minfutureYear + "-" + minfutureMonth + "-"+ minfutureDate ;
				document.getElementById("checkOutDate").setAttribute('min' ,minFDate );
				datePicker2.addEventListener("input" , ()=>
				{
					if (datePicker2.value)
					{
						check_button.addEventListener("click", function()
						{
  							for (var i = 0; i < selects.length; i++) 
							{
   			 					selects[i].disabled = false;               //here we enable our select tag so that user can select no of rooms
								selects[i].style.opacity = 1;
  								selects[i].style.pointerEvents = "auto";
  							}	
							//right now i am blocking the user to input again check in , out date 
							datePicker1.setAttribute("disabled" , true);
				 			datePicker1.style.opacity = 0.5;
				   			datePicker1.pointerEvents = "none";
				   			datePicker2.setAttribute("disabled", true);
				  			datePicker2.style.opacity = 0.5;
				   			datePicker2.pointerEvents = "none";	
	
				       });
					}
				  var date1=new Date(datePicker1.value);
				  var date2=new Date(datePicker2.value);	
  					// Convert both dates to milliseconds
 					var date1Ms = date1.getTime();
 				    var date2Ms = date2.getTime();
 					 var diffMs = Math.abs(date1Ms - date2Ms);
 				 	// Convert the difference to days 
 				 	 Days=Math.floor(diffMs / (1000 * 60 * 60 * 24));
				}
				)
			}
		} 
		);
	
		// Get all the select and p tag elements
	const selectElements = document.querySelectorAll(".Selectrooms");
	const totalPriceElement = document.querySelector(".bill");
	// Initialize the total price to zero
	// total for each Select div
	// max total is actual invoice
	//array is use to store the price of each Select Div (that is room type) at given index , sum of array is total bill which store in a variable called maxTotal
	
  	let total =0;
  	let maxtotal=0;
	let arr=[0,0,0,0,0];
  	// Loop through all the select elements and calculate the total price
	for (let i = 0; i < selectElements.length; i++) 
	{
  		const selectElement = selectElements[i];
		// here we use "change" listener not "click" beacuse we want that if a user change no of rooms then only this function perform otherwise previous value will be used
		selectElement.addEventListener("change",function()
		{
			 total = 0;//every time user change value that is from 3 room to 4 rooms or 4 to 3 , first value will be set to 0 and then re-calculate
			const price = selectElement.getAttribute("data-price");
  			const quantity = selectElement.value;
  			total += price * quantity;
  			arr[i]=total;
  			maxtotal=arr[0]+arr[1]+arr[2]+arr[3]+arr[4];
  			const bill = document.getElementById("bill");
  			bill.innerText = "Lodging Fee: $" + (maxtotal*Days);//setting bill value
  		}) 
	}
	</script> 
</body>
</html>

